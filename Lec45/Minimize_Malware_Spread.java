package Lec45;
import java.util.*;
public class Minimize_Malware_Spread {

	public class DSU {
		public class Node {
			int val;
			Node parent;
			int rank;

		}

		HashMap<Integer, Node> map = new HashMap<>();

		public void createSet(int v) {
			Node nn = new Node();
			nn.val = v;
			nn.parent = nn;
			nn.rank = 1;
			map.put(v, nn);
		}

		public int find(int v) {
			Node nn = map.get(v);

			return find(nn).val;

		}

		private Node find(Node nn) {
			if (nn.parent == nn) {
				return nn;
			}

			return nn.parent=find(nn.parent);

		}

		public void union(int v1, int v2) {
			Node n1 = map.get(v1);
			Node n2 = map.get(v2);

			Node re1 = find(n1);
			Node re2 = find(n2);

			re1.parent = re2;
			re2.rank = re1.rank + re2.rank;

		}

		public int size(int v) {
			Node nn = map.get(v);
			return find(nn).rank;
		}

	}

}
